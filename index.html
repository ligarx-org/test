<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Solar System</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            max-width: 300px;
            pointer-events: none;
        }
        #controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
        }
        button {
            background-color: #444;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #666;
        }
        #speedDisplay {
            color: white;
            display: flex;
            align-items: center;
            padding: 0 10px;
        }
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div id="info">
        <h2>Solar System Simulation</h2>
        <p>‚Ä¢ Use mouse to rotate view</p>
        <p>‚Ä¢ Scroll to zoom in/out</p>
        <p>‚Ä¢ Hold left click to rotate camera</p>
        <p>‚Ä¢ Hold right click to pan</p>
    </div>
    
    <div id="controls">
        <button id="speedDown">‚è™ Slow Down</button>
        <button id="resetSpeed">‚èπ Reset Speed</button>
        <button id="speedUp">‚è© Speed Up</button>
        <button id="toggleOrbits">üîÑ Toggle Orbits</button>
        <div id="speedDisplay">Speed: 1x</div>
    </div>
    
    <div id="loading">Loading textures, please wait...</div>

    <script>
        // Main Three.js code
        document.addEventListener('DOMContentLoaded', function() {
            // Show loading message
            const loadingElement = document.getElementById('loading');
            
            // Create a promise-based texture loader
            function loadTexture(url) {
                return new Promise((resolve, reject) => {
                    const loader = new THREE.TextureLoader();
                    loader.load(url, resolve, undefined, reject);
                });
            }
            
            // Load all textures first
            Promise.all([
                // Sun texture
                loadTexture('https://solar-textures.s3.amazonaws.com/sun.jpg'),
                
                // Planet textures
                loadTexture('https://solar-textures.s3.amazonaws.com/mercury.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/venus.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/earth.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/mars.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/jupiter.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/saturn.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/saturn_ring.png'),
                loadTexture('https://solar-textures.s3.amazonaws.com/uranus.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/uranus_ring.png'),
                loadTexture('https://solar-textures.s3.amazonaws.com/neptune.jpg'),
                loadTexture('https://solar-textures.s3.amazonaws.com/pluto.jpg'),
                
                // Load Three.js from CDN
                new Promise((resolve) => {
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js';
                    script.onload = resolve;
                    document.head.appendChild(script);
                }),
                
                // Load OrbitControls from CDN
                new Promise((resolve) => {
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js';
                    script.onload = resolve;
                    document.head.appendChild(script);
                })
            ]).then((textures) => {
                // Hide loading message
                loadingElement.style.display = 'none';
                
                // Extract loaded textures
                const [
                    sunTexture,
                    mercuryTexture,
                    venusTexture,
                    earthTexture,
                    marsTexture,
                    jupiterTexture,
                    saturnTexture,
                    saturnRingTexture,
                    uranusTexture,
                    uranusRingTexture,
                    neptuneTexture,
                    plutoTexture
                ] = textures;
                
                // Now initialize Three.js
                initThreeJS();
                
                function initThreeJS() {
                    // Scene setup
                    const scene = new THREE.Scene();
                    
                    // Camera setup
                    const camera = new THREE.PerspectiveCamera(
                        45, 
                        window.innerWidth / window.innerHeight, 
                        0.1, 
                        5000
                    );
                    camera.position.set(0, 200, 500);
                    
                    // Renderer setup
                    const renderer = new THREE.WebGLRenderer({ antialias: true });
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.shadowMap.enabled = true;
                    renderer.setPixelRatio(window.devicePixelRatio);
                    document.body.appendChild(renderer.domElement);
                    
                    // Controls
                    const controls = new THREE.OrbitControls(camera, renderer.domElement);
                    controls.enableDamping = true;
                    controls.dampingFactor = 0.05;
                    controls.minDistance = 100;
                    controls.maxDistance = 2000;
                    
                    // Background - Starfield
                    const starGeometry = new THREE.BufferGeometry();
                    const starMaterial = new THREE.PointsMaterial({
                        color: 0xffffff,
                        size: 1.5,
                        sizeAttenuation: false,
                        transparent: true,
                        opacity: 0.8
                    });
                    
                    const starVertices = [];
                    for (let i = 0; i < 10000; i++) {
                        const x = (Math.random() - 0.5) * 3000;
                        const y = (Math.random() - 0.5) * 3000;
                        const z = (Math.random() - 0.5) * 3000;
                        starVertices.push(x, y, z);
                    }
                    
                    starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
                    const stars = new THREE.Points(starGeometry, starMaterial);
                    scene.add(stars);
                    
                    // Lighting
                    const ambientLight = new THREE.AmbientLight(0x333333);
                    scene.add(ambientLight);
                    
                    const sunLight = new THREE.PointLight(0xfff5d1, 2, 2000);
                    sunLight.castShadow = true;
                    sunLight.shadow.mapSize.width = 2048;
                    sunLight.shadow.mapSize.height = 2048;
                    scene.add(sunLight);
                    
                    // Helper function to create planets
                    function createPlanet(size, texture, position, ring) {
                        const material = new THREE.MeshPhongMaterial({ 
                            map: texture,
                            shininess: 5,
                            specular: new THREE.Color(0x333333)
                        });
                        const geometry = new THREE.SphereGeometry(size, 64, 64);
                        const planet = new THREE.Mesh(geometry, material);
                        planet.castShadow = true;
                        planet.receiveShadow = true;
                        
                        const planetObj = new THREE.Object3D();
                        planetObj.add(planet);
                        
                        if (ring) {
                            const ringGeometry = new THREE.RingGeometry(
                                ring.innerRadius, 
                                ring.outerRadius, 
                                64
                            );
                            const ringMaterial = new THREE.MeshPhongMaterial({ 
                                map: ring.texture, 
                                side: THREE.DoubleSide,
                                transparent: true,
                                opacity: 0.8,
                                shininess: 30
                            });
                            const ringMesh = new THREE.Mesh(ringGeometry, ringMaterial);
                            ringMesh.rotation.x = Math.PI / 2;
                            planetObj.add(ringMesh);
                        }
                        
                        scene.add(planetObj);
                        planet.position.x = position;
                        
                        return {
                            mesh: planet,
                            obj: planetObj,
                            orbitSpeed: (Math.random() * 0.01) + 0.001,
                            rotationSpeed: (Math.random() * 0.02) + 0.005
                        };
                    }
                    
                    // Create the Sun
                    const sunGeometry = new THREE.SphereGeometry(30, 64, 64);
                    const sunMaterial = new THREE.MeshBasicMaterial({
                        map: sunTexture
                    });
                    const sun = new THREE.Mesh(sunGeometry, sunMaterial);
                    sunLight.position.set(0, 0, 0);
                    scene.add(sun);
                    
                    // Create planets with more accurate relative sizes and distances
                    const planets = [
                        createPlanet(4.8, mercuryTexture, 70),  // Mercury
                        createPlanet(12.1, venusTexture, 100),   // Venus
                        createPlanet(12.7, earthTexture, 140),   // Earth
                        createPlanet(6.7, marsTexture, 180),     // Mars
                        createPlanet(139.8, jupiterTexture, 250), // Jupiter
                        createPlanet(116.4, saturnTexture, 350, {  // Saturn
                            innerRadius: 60,
                            outerRadius: 140,
                            texture: saturnRingTexture
                        }),
                        createPlanet(50.7, uranusTexture, 450, {    // Uranus
                            innerRadius: 30,
                            outerRadius: 60,
                            texture: uranusRingTexture
                        }),
                        createPlanet(49.2, neptuneTexture, 550),    // Neptune
                        createPlanet(2.4, plutoTexture, 600)        // Pluto
                    ];
                    
                    // Create orbit lines
                    const orbitLines = [];
                    const orbitMaterial = new THREE.LineBasicMaterial({ 
                        color: 0x555555, 
                        transparent: true, 
                        opacity: 0.5 
                    });
                    
                    [70, 100, 140, 180, 250, 350, 450, 550, 600].forEach(radius => {
                        const orbitGeometry = new THREE.BufferGeometry();
                        const points = [];
                        const segments = 128;
                        
                        for (let i = 0; i <= segments; i++) {
                            const theta = (i / segments) * Math.PI * 2;
                            points.push(
                                new THREE.Vector3(
                                    Math.cos(theta) * radius,
                                    0,
                                    Math.sin(theta) * radius
                                )
                            );
                        }
                        
                        orbitGeometry.setFromPoints(points);
                        const orbitLine = new THREE.Line(orbitGeometry, orbitMaterial);
                        scene.add(orbitLine);
                        orbitLines.push(orbitLine);
                    });
                    
                    // Animation variables
                    let animationSpeed = 1;
                    let showOrbits = true;
                    
                    // Controls UI
                    document.getElementById('speedUp').addEventListener('click', () => {
                        animationSpeed *= 1.5;
                        updateSpeedDisplay();
                    });
                    
                    document.getElementById('speedDown').addEventListener('click', () => {
                        animationSpeed /= 1.5;
                        updateSpeedDisplay();
                    });
                    
                    document.getElementById('resetSpeed').addEventListener('click', () => {
                        animationSpeed = 1;
                        updateSpeedDisplay();
                    });
                    
                    document.getElementById('toggleOrbits').addEventListener('click', () => {
                        showOrbits = !showOrbits;
                        orbitLines.forEach(orbit => {
                            orbit.visible = showOrbits;
                        });
                    });
                    
                    function updateSpeedDisplay() {
                        document.getElementById('speedDisplay').textContent = 
                            `Speed: ${animationSpeed.toFixed(2)}x`;
                    }
                    
                    // Animation loop
                    function animate() {
                        requestAnimationFrame(animate);
                        
                        // Rotate the Sun
                        sun.rotation.y += 0.002 * animationSpeed;
                        
                        // Update planets
                        planets.forEach(planet => {
                            planet.obj.rotation.y += planet.orbitSpeed * animationSpeed;
                            planet.mesh.rotation.y += planet.rotationSpeed * animationSpeed;
                        });
                        
                        // Update controls
                        controls.update();
                        
                        // Render scene
                        renderer.render(scene, camera);
                    }
                    
                    // Handle window resize
                    window.addEventListener('resize', () => {
                        camera.aspect = window.innerWidth / window.innerHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(window.innerWidth, window.innerHeight);
                    });
                    
                    // Start animation
                    animate();
                }
            }).catch(error => {
                loadingElement.textContent = 'Error loading textures: ' + error.message;
                console.error('Texture loading error:', error);
            });
        });
    </script>
</body>
</html>
